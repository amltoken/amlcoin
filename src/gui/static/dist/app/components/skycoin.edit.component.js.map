{"version":3,"sources":["app/components/skycoin.edit.component.ts"],"names":[],"mappings":"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","file":"skycoin.edit.component.js","sourcesContent":["/**\n * Created by nakul.pandey@gmail.com on 01/01/17.\n */\n\nimport {Component, Input, EventEmitter, ElementRef, Output, OnInit} from '@angular/core';\nimport {Wallet} from '../model/wallet.pojo';\nimport {WalletService} from '../services/wallet.service';\ndeclare var toastr: any;\ndeclare var _: any;\n\n@Component({\n    selector: 'skycoin-edit',\n    styles: [\n        ` #skycoin-edit-ic {\n        margin-left: 10px;\n        color: #d9d9d9;\n        }\n        .skycoin-edit-comp {\n            padding:6px;\n            border-radius: 3px;\n        }\n        .active-skycoin-edit {\n            background-color: #f0f0f0;\n            border: 1px solid #d9d9d9;\n        }\n        input {\n            border-radius: 5px;\n            box-shadow: none;\n            border: 1px solid #dedede;\n            min-width: 5px;\n        }\n        .skycoin-edit-buttons {\n            background-color: #f0f0f0;\n            border: 1px solid #ccc;\n            border-top: none;\n            border-radius: 0 0 3px 3px;\n            box-shadow: 0 3px 6px rgba(111,111,111,0.2);\n            outline: none;\n            padding: 3px;\n            position: absolute;\n            margin-left: 6px;\n            z-index: 1;\n        }\n        .skycoin-edit-comp:hover {\n            border: 1px solid grey;\n        }\n        .skycoin-edit-comp:hover > skycoin-edit-ic {\n            display:block;\n        }\n        .skycoin-edit-save {\n            margin-right:3px;\n        }\n        .skycoin-edit-active {\n            background-color: #f0f0f0;\n            border: 1px solid #d9d9d9;\n        }\n        .ng-invalid {\n                background: #ffb8b8;\n            }\n        .err-bubble {\n            position: absolute;\n            margin: 16px 100px;\n            border: 1px solid red;\n            font-size: 14px;\n            background: #ffb8b8;\n            padding: 10px;\n            border-radius: 7px;\n        }\n       `\n    ],\n    template: `<span class='skycoin-edit-comp' [ngClass]=\"{'skycoin-edit-active':show}\">\n<input *ngIf='show' [ngClass]=\"{'ng-invalid': invalid}\" (ngModelChange)=\"validate($event)\" type='text' [(ngModel)]='text' />\n<div class='err-bubble' *ngIf=\"invalid\">{{error || \" must contain \" + min + \" to -\" + max +\" chars.\"}}</div>\n<i class=\"fa fa-edit\" (click)='makeEditable()' id='skycoin-edit-ic' *ngIf='!show'></i>\n<span *ngIf='!show' (click)='makeEditable()'>{{text || '-Empty Field-'}}</span>\n</span>\n<div class='skycoin-edit-buttons' *ngIf='show'>\n<button class='btn-x-sm' (click)='callSave()'><i class=\"fa fa-check\"></i></button>\n<button class='btn-x-sm' (click)='cancelEditable()'><i class=\"fa fa-times\"></i></button>\n</div>`,\n\n    host: {\n        \"(document: click)\": \"compareEvent($event)\",\n        \"(click)\": \"trackEvent($event)\"\n    },\n    providers: [WalletService]\n})\n\nexport class SkyCoinEditComponent implements OnInit {\n\n    @Input('text') text;\n    @Input('wallets') wallets: Wallet[];\n    @Input('walletId') walletId;\n\n    @Output() onWalletChanged = new EventEmitter();\n\n    originalText;\n    tracker;\n    el: ElementRef;\n    show = false;\n    m: Number = 3;\n    min = 0;\n    max = 100;\n    error;\n    regex;\n    invalid = false;\n\n    constructor(el: ElementRef, private _walletService: WalletService) {\n        this.el = el;\n    }\n\n    ngOnInit() {\n        this.originalText = this.text;\n    }\n\n    validate(text) {\n        if (this.regex) {\n            var re = new RegExp('' + this.regex, \"ig\");\n            if (re.test(text)) {\n                this.invalid = false;\n            }\n            else {\n                this.invalid = true;\n            }\n        }\n        else {\n            if ((text.length <= this.max) && (text.length >= this.min)) {\n                this.invalid = false;\n            }\n            else {\n                this.invalid = true;\n            }\n        }\n    }\n\n    makeEditable() {\n        if (this.show == false) {\n            this.show = true;\n        }\n    }\n\n    compareEvent(globalEvent) {\n        if (this.tracker != globalEvent && this.show) {\n            this.cancelEditable();\n        }\n    }\n\n    trackEvent(newHostEvent) {\n        this.tracker = newHostEvent;\n    }\n\n    cancelEditable() {\n        this.show = false;\n        this.invalid = false;\n        this.text = this.originalText;\n    }\n\n    callSave() {\n        if (!this.invalid && !this.isDuplicate(this.text)) {\n            var data = {};\n            data[\"newText\"] = this.text;\n            data[\"walletId\"] = this.walletId;\n\n            this._walletService.updateWallet(data).subscribe(response => {\n                    this.onWalletChanged.emit(data);\n                    this.show = false;\n                    toastr.info(\"Wallet name updated\");\n                },\n                err => {\n                    this.cancelEditable();\n                    toastr.error(\"Unable to update the name. Please try after some time\");\n                }\n            );\n        }\n    }\n\n    isDuplicate(text) {\n        var old = _.find(this.wallets, function (o) {\n            return (o.meta.label == text)\n        })\n\n        if (old) {\n            toastr.error(\"This wallet label is used already\");\n            this.cancelEditable();\n            return true;\n        }\n        return false;\n    }\n}\n"]}